function triggerWeatherEventsCheck() {
    var selectedCountries = $("#ddlreschApptCountry").val();
    var selectedStates = $("#ddlreschApptState").val();

    if (selectedCountries && selectedCountries.includes("USA") && (!selectedStates || selectedStates.length === 0)) {
        alert("Please select a state when USA is selected.");
        return;
    }

    var data = {
        Country: selectedCountries,
        State: selectedStates
    };

    $.ajax({
        url: '/RescheduleReason/GetWeatherEvents',
        type: 'POST',
        data: JSON.stringify(data),
        contentType: 'application/json; charset=utf-8',
        success: function (response) {
            updateWeatherEventsDropdown(response);
        },
        error: function (xhr, status, error) {
            alert("Error fetching weather events.");
        }
    });
}


/////

function updateWeatherEventsDropdown(events) {
    var $dropdown = $("#ddlreschWatherEvent");
    $dropdown.empty();
    $dropdown.append('<option value="">- Select Weather Alert -</option>');
    if (events && events.length) {
        events.forEach(function (event) {
            var text = "Event: " + event.WeatherEvent + ", Type: " + event.WeatherType +
                ", Description: " + event.Description +
                " [" + event.StartDate + " - " + event.EndDate + "]";
            $dropdown.append('<option value="' + event.WeatherEventId + '">' + text + '</option>');
        });
    }
}
