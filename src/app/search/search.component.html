@model Qtc.PartnerPortal.WebApp.Models.CancelReschWeatherAlertViewModel

@{    
    var idDDCountry = $"ddl{Model.Section}ApptCountry";
    var idDDState = $"ddl{Model.Section}ApptState";
    var idDDWeatherEvent = $"ddl{Model.Section}WeatherEvent";
}

<!-- Weather Alerts -->
<div class="row mt-3 mb-2">
    <div class="row justify-content-between">
        <div class="col-3 p-2 h6 darkpurpleText">
            <span class="fa-stack">
                <i class="fa fa-circle-thin fa-stack-2x text-primary"></i>
                <i class="fa fa-cloud fa-stack-1x text-black"></i>
                <i class="fa fa-bolt fa-stack-1x text-danger mt-1"></i>
            </span>
            <b> Weather Alerts</b>
        </div>
    </div>

    <div class="col-md-4">
        <label title="Filter weather events by the Country" for="@idDDCountry">Weather Alert Countries</label>
        <div class="form-group">
           <select id="@idDDCountry" name="Country" multiple="multiple" class="form-control mb-2 qtc-weather-alert-multi-select">
@foreach (var item in Model.CountryList)
{
    <option value="@item.Key"
        @if (Model.Country != null && Model.Country.Contains(item.Key))
        { <text>selected="selected"</text>; }>
        @item.Value
    </option>
}
</select>
        </div>
    </div>
    <div class="col-md-5">       
        <div class="form-group">
            <label title="Filter weather events by the State (US)" for="@idDDState">Weather Alert States (US)</label>
            <select class="form-control mb-2 qtc-weather-alert-multi-select" id="@idDDState" name="States" placeholder="- Select State -" multiple="multiple">
                @foreach (var item in Model.StatesList)
                {
                    <option value="@item.Key" selected="@(Model.State != null && Model.State.Contains(item.Key))">
                        @item.Value
                    </option>
                }
            </select>
        </div>
    </div>
    <div class="col-md-12 mt-3">
        <label title="Select the weather event affected the reschedule" for="idDDWeatherEvent">Weather Alert</label>
        <div class="form-group">
            <select class="form-control" id="@idDDWeatherEvent" name="Weather Alerts" placeholder="- Select Weather Alert -">
                @* @foreach (var item in Model.WeatherEventList) *@
                @* { *@
                @*     <option value="@item.WeatherEventId"> *@
                @*         Event: @item.WeatherEvent, Type: @item.WeatherType, Description: @item.Description [ @item.StartDate.ToShortDateString() -  @item.EndDate.ToShortDateString() ] *@
                @*     </option> *@
                @* } *@
            </select>
        </div>
    </div>
</div>

            <script>
                   $(document).ready(function() {
        // Get default values from the rendered select element
        var defaultValues = $('#@idDDCountry').val() || [];

        // Initialize multiselect
        $('#@idDDCountry').multiselect({
            buttonClass: 'btn btn-default',
            templates: {
                button: '<button type="button" class="multiselect dropdown-toggle form-control-drop-down form-control" data-bs-toggle="dropdown"></button>'
            },
            includeSelectAllOption: true,
            enableFiltering: true,
            // Update button text immediately
            onChange: function() {
                $('#@idDDCountry').multiselect('updateButtonText');
            }
        });

        // Set default selections after initialization
        if (defaultValues.length > 0) {
            setTimeout(function() {
                $('#@idDDCountry').multiselect('select', defaultValues);
                $('#@idDDCountry').multiselect('updateButtonText');
            }, 100);
        }
    });

            </script>
