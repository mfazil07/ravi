describe('countryStateChange', () => {
  let mockClaimantsWeatherAlertsService: any;

  beforeEach(() => {
    // Create a mock service
    mockClaimantsWeatherAlertsService = {
      getClaimantInfo: jasmine.createSpy('getClaimantInfo').and.returnValue(
        of({
          country: 'USA',
          state: 'CA',
          mappedCountries: ['USA', 'CAN'],
          mappedStates: ['CA', 'TX']
        })
      )
    };

    // Override the provider for ClaimantsWeatherAlertsService
    TestBed.overrideProvider('ClaimantsWeatherAlertsService', {
      useValue: mockClaimantsWeatherAlertsService
    });

    // Reinitialize the component
    fixture = TestBed.createComponent(NotificationSearchFormComponent);
    component = fixture.componentInstance;

    // Set up the required initial values
    component.claimantId = 123;
    component.caseId = 1;
    component.notificationSearch = {
      mappedEvents: false,
      frmSrchCountry: [],
      frmSrchState: []
    };
    component.countries = [
      { key: 'USA', value: 'United States' },
      { key: 'CAN', value: 'Canada' }
    ];
  });

  it('should call getClaimantInfo with correct parameters', () => {
    component.countryStateChange();
    expect(mockClaimantsWeatherAlertsService.getClaimantInfo).toHaveBeenCalledWith(
      123,
      1,
      false
    );
  });

  it('should update caseDetails with the response data', () => {
    component.countryStateChange();
    expect(component.caseDetails).toEqual({
      country: 'USA',
      state: 'CA',
      mappedCountries: ['USA', 'CAN'],
      mappedStates: ['CA', 'TX']
    });
  });

  it('should handle error response', () => {
    const errorResponse = new HttpErrorResponse({
      error: 'test 404 error',
      status: 404,
      statusText: 'Not Found'
    });

    mockClaimantsWeatherAlertsService.getClaimantInfo.and.returnValue(
      throwError(() => errorResponse)
    );

    spyOn(component, 'handleError');
    component.countryStateChange();

    expect(component.handleError).toHaveBeenCalledWith(errorResponse);
  });

  // Additional test cases...
});
